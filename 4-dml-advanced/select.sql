--1. ?????????? ???????????? ? ?????? ?????;
--select mc."name" , count(rmc.*) from r_musicians_catigories rmc, music_categories mc  where mc.id = rmc.category group by mc."name" 

--2. ?????????? ??????, ???????? ? ??????? 2019-2020 ?????;
--select a."name", count(t.*)  from tracks t, albums a where a."year" between 2019 and 2020 and t.album_id =a.id group by a."name" 

--3.??????? ????????????????? ?????? ?? ??????? ???????;
--select a."name" , avg(t.duraion)  from tracks t, albums a where t.album_id =a.id group by a."name" 

--4. ??? ???????????, ??????? ?? ????????? ??????? ? 2020 ????;
/*select m."name" 
	from musicians m , albums a, r_musicians_albums rma  
	where a."year" != 2020 and rma.musician =m.id and rma.album =a.id */  
--???????? ?????? ??????
--5. ???????? ?????????, ? ??????? ???????????? ?????????? ??????????? (???????? ????);


--9. ???????? ????????, ?????????? ?????????? ?????????? ??????.
select v.AlbumName, v.TracksCount 
	from (select a."name" as AlbumName, count(t.*) as TracksCount  from tracks t, albums a where  t.album_id =a.id group by a."name") as v, 
		(select a."name" as AlbumName, count(t.*) as TracksCount  from tracks t, albums a where  t.album_id =a.id group by a."name" order by 2 ASC limit 1) as v2
where v.TracksCount = v2.TracksCount


 